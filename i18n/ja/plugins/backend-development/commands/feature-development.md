> **[English](../../../plugins/backend-development/commands/feature-development.md)** | **日本語**

要求から本番デプロイまでのエンドツーエンドの機能開発をオーケストレーション：

[Extended thinking: このワークフローは、発見・計画から実装、テスト、デプロイまでの包括的な機能開発フェーズを通じて、専門的なエージェントをオーケストレーションします。各フェーズは前のフェーズの出力に基づいて構築され、一貫性のある機能提供を保証します。このワークフローは、複数の開発手法（従来型、TDD/BDD、DDD）、機能の複雑さレベル、そしてフィーチャーフラグ、段階的ロールアウト、可観測性ファースト開発を含む最新のデプロイ戦略をサポートします。エージェントは、開発ライフサイクル全体を通じて一貫性と品質を維持するために、前のフェーズから詳細なコンテキストを受け取ります。]

## 設定オプション

### 開発手法
- **traditional**: 実装後にテストを行う順次開発
- **tdd**: レッド・グリーン・リファクタサイクルを用いたテスト駆動開発
- **bdd**: シナリオベースのテストを用いた振る舞い駆動開発
- **ddd**: 境界づけられたコンテキストと集約を用いたドメイン駆動設計

### 機能の複雑さ
- **simple**: 単一サービス、最小限の統合（1〜2日）
- **medium**: 複数サービス、中程度の統合（3〜5日）
- **complex**: クロスドメイン、広範な統合（1〜2週間）
- **epic**: 主要なアーキテクチャ変更、複数チーム（2週間以上）

### デプロイ戦略
- **direct**: すべてのユーザーへの即時ロールアウト
- **canary**: トラフィックの5%から始める段階的ロールアウト
- **feature-flag**: フィーチャートグルによる制御されたアクティベーション
- **blue-green**: 即座にロールバック可能なゼロダウンタイムデプロイ
- **a-b-test**: 実験とメトリクスのためのトラフィック分割

## フェーズ1: 発見と要求計画

1. **ビジネス分析と要求**
   - subagent_type="business-analytics::business-analyst"でTaskツールを使用
   - プロンプト: "$ARGUMENTSの機能要求を分析してください。ユーザーストーリー、受け入れ基準、成功メトリクス、ビジネス価値を定義してください。ステークホルダー、依存関係、リスクを特定してください。明確なスコープ境界を持つ機能仕様ドキュメントを作成してください。"
   - 期待される出力: ユーザーストーリー、成功メトリクス、リスク評価を含む要求ドキュメント
   - コンテキスト: 初期機能リクエストとビジネスコンテキスト

2. **技術アーキテクチャ設計**
   - subagent_type="comprehensive-review::architect-review"でTaskツールを使用
   - プロンプト: "機能の技術アーキテクチャを設計してください: $ARGUMENTS。要求を使用: [ステップ1のビジネス分析を含める]。サービス境界、APIコントラクト、データモデル、統合ポイント、技術スタックを定義してください。スケーラビリティ、パフォーマンス、セキュリティ要件を考慮してください。"
   - 期待される出力: アーキテクチャ図、API仕様、データモデルを含む技術設計ドキュメント
   - コンテキスト: ビジネス要求、既存のシステムアーキテクチャ

3. **実現可能性とリスク評価**
   - subagent_type="security-scanning::security-auditor"でTaskツールを使用
   - プロンプト: "機能のセキュリティ影響とリスクを評価してください: $ARGUMENTS。アーキテクチャをレビュー: [ステップ2の技術設計を含める]。セキュリティ要件、コンプライアンスニーズ、データプライバシーの懸念、潜在的な脆弱性を特定してください。"
   - 期待される出力: リスクマトリクス、コンプライアンスチェックリスト、緩和戦略を含むセキュリティ評価
   - コンテキスト: 技術設計、規制要件

## フェーズ2: 実装と開発

4. **バックエンドサービス実装**
   - subagent_type="backend-architect"でTaskツールを使用
   - プロンプト: "次の機能のバックエンドサービスを実装してください: $ARGUMENTS。技術設計に従ってください: [ステップ2のアーキテクチャを含める]。RESTful/GraphQL APIを構築し、ビジネスロジックを実装し、データレイヤーと統合し、レジリエンスパターン（サーキットブレーカー、リトライ）を追加し、キャッシング戦略を実装してください。段階的ロールアウトのためのフィーチャーフラグを含めてください。"
   - 期待される出力: API、ビジネスロジック、データベース統合、フィーチャーフラグを含むバックエンドサービス
   - コンテキスト: 技術設計、APIコントラクト、データモデル

5. **フロントエンド実装**
   - subagent_type="frontend-mobile-development::frontend-developer"でTaskツールを使用
   - プロンプト: "次の機能のフロントエンドコンポーネントを構築してください: $ARGUMENTS。バックエンドAPIと統合: [ステップ4のAPIエンドポイントを含める]。レスポンシブUI、状態管理、エラーハンドリング、ローディング状態、分析トラッキングを実装してください。A/Bテスト機能のためのフィーチャーフラグ統合を追加してください。"
   - 期待される出力: API統合、状態管理、分析を含むフロントエンドコンポーネント
   - コンテキスト: バックエンドAPI、UI/UXデザイン、ユーザーストーリー

6. **データパイプラインと統合**
   - subagent_type="data-engineering::data-engineer"でTaskツールを使用
   - プロンプト: "次の機能のデータパイプラインを構築してください: $ARGUMENTS。ETL/ELTプロセスを設計し、データ検証を実装し、分析イベントを作成し、データ品質モニタリングを設定してください。機能使用追跡のためにプロダクト分析プラットフォームと統合してください。"
   - 期待される出力: データパイプライン、分析イベント、データ品質チェック
   - コンテキスト: データ要求、分析ニーズ、既存のデータインフラストラクチャ

## フェーズ3: テストと品質保証

7. **自動テストスイート**
   - subagent_type="unit-testing::test-automator"でTaskツールを使用
   - プロンプト: "次の機能の包括的なテストスイートを作成してください: $ARGUMENTS。バックエンド: [ステップ4から]とフロントエンド: [ステップ5から]のユニットテストを作成してください。APIエンドポイントの統合テスト、重要なユーザージャーニーのE2Eテスト、スケーラビリティ検証のためのパフォーマンステストを追加してください。最低80%のコードカバレッジを確保してください。"
   - 期待される出力: ユニット、統合、E2E、パフォーマンステストを含むテストスイート
   - コンテキスト: 実装コード、受け入れ基準、テスト要件

8. **セキュリティ検証**
   - subagent_type="security-scanning::security-auditor"でTaskツールを使用
   - プロンプト: "次の機能のセキュリティテストを実行してください: $ARGUMENTS。実装をレビュー: [ステップ4〜5のバックエンドとフロントエンドを含める]。OWASPチェック、ペネトレーションテスト、依存関係スキャン、コンプライアンス検証を実行してください。データ暗号化、認証、認可を検証してください。"
   - 期待される出力: セキュリティテスト結果、脆弱性レポート、修復アクション
   - コンテキスト: 実装コード、セキュリティ要件

9. **パフォーマンス最適化**
   - subagent_type="application-performance::performance-engineer"でTaskツールを使用
   - プロンプト: "次の機能のパフォーマンスを最適化してください: $ARGUMENTS。バックエンドサービス: [ステップ4から]とフロントエンド: [ステップ5から]を分析してください。コードをプロファイリングし、クエリを最適化し、キャッシングを実装し、バンドルサイズを削減し、読み込み時間を改善してください。パフォーマンスバジェットとモニタリングを設定してください。"
   - 期待される出力: パフォーマンス改善、最適化レポート、パフォーマンスメトリクス
   - コンテキスト: 実装コード、パフォーマンス要件

## フェーズ4: デプロイとモニタリング

10. **デプロイ戦略とパイプライン**
    - subagent_type="deployment-strategies::deployment-engineer"でTaskツールを使用
    - プロンプト: "次の機能のデプロイを準備してください: $ARGUMENTS。自動テストを含むCI/CDパイプラインを作成: [ステップ7から]。段階的ロールアウトのためのフィーチャーフラグを設定し、ブルーグリーンデプロイを実装し、ロールバック手順を設定してください。デプロイランブックとロールバック計画を作成してください。"
    - 期待される出力: CI/CDパイプライン、デプロイ設定、ロールバック手順
    - コンテキスト: テストスイート、インフラストラクチャ要件、デプロイ戦略

11. **可観測性とモニタリング**
    - subagent_type="observability-monitoring::observability-engineer"でTaskツールを使用
    - プロンプト: "次の機能の可観測性を設定してください: $ARGUMENTS。分散トレーシング、カスタムメトリクス、エラートラッキング、アラートを実装してください。機能使用、パフォーマンスメトリクス、エラー率、ビジネスKPIのダッシュボードを作成してください。自動アラート付きのSLO/SLIを設定してください。"
    - 期待される出力: モニタリングダッシュボード、アラート、SLO定義、可観測性インフラストラクチャ
    - コンテキスト: 機能実装、成功メトリクス、運用要件

12. **ドキュメントと知識移転**
    - subagent_type="documentation-generation::docs-architect"でTaskツールを使用
    - プロンプト: "次の機能の包括的なドキュメントを生成してください: $ARGUMENTS。APIドキュメント、ユーザーガイド、デプロイガイド、トラブルシューティングランブックを作成してください。アーキテクチャ図、データフロー図、統合ガイドを含めてください。コミットから自動変更ログを生成してください。"
    - 期待される出力: APIドキュメント、ユーザーガイド、ランブック、アーキテクチャドキュメント
    - コンテキスト: すべての前のフェーズの出力

## 実行パラメータ

### 必須パラメータ
- **--feature**: 機能名と説明
- **--methodology**: 開発アプローチ (traditional|tdd|bdd|ddd)
- **--complexity**: 機能の複雑さレベル (simple|medium|complex|epic)

### オプションパラメータ
- **--deployment-strategy**: デプロイアプローチ (direct|canary|feature-flag|blue-green|a-b-test)
- **--test-coverage-min**: 最小テストカバレッジ閾値 (デフォルト: 80%)
- **--performance-budget**: パフォーマンス要件 (例: <200msレスポンス時間)
- **--rollout-percentage**: 段階的デプロイの初期ロールアウト割合 (デフォルト: 5%)
- **--feature-flag-service**: フィーチャーフラグプロバイダー (launchdarkly|split|unleash|custom)
- **--analytics-platform**: 分析統合 (segment|amplitude|mixpanel|custom)
- **--monitoring-stack**: 可観測性ツール (datadog|newrelic|grafana|custom)

## 成功基準

- ビジネス要求からのすべての受け入れ基準が満たされている
- テストカバレッジが最小閾値を超えている（デフォルト80%）
- セキュリティスキャンで重大な脆弱性が見つからない
- パフォーマンスが定義されたバジェットとSLOを満たしている
- 制御されたロールアウトのためのフィーチャーフラグが設定されている
- モニタリングとアラートが完全に稼働している
- ドキュメントが完全で承認されている
- ロールバック機能を備えた本番環境への成功したデプロイ
- プロダクト分析が機能使用を追跡している
- A/Bテストメトリクスが設定されている（該当する場合）

## ロールバック戦略

デプロイ中またはデプロイ後に問題が発生した場合：
1. 即座のフィーチャーフラグ無効化（< 1分）
2. ブルーグリーントラフィック切り替え（< 5分）
3. CI/CDによる完全なデプロイロールバック（< 15分）
4. 必要に応じてデータベースマイグレーションのロールバック（データチームと調整）
5. インシデントポストモーテムと再デプロイ前の修正

機能の説明: $ARGUMENTS
